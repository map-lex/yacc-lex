%{
#include <stdio.h>

int words = 0;
int chars = 0;
int blanks = 0;
int lines = 0;
%}

%%

/* Match words (contiguous letters/digits/underscore) */
[A-Za-z0-9_]+    { words++; chars += yyleng; }

/* Match spaces and tabs */
[ \t]+            { blanks += yyleng; chars += yyleng; }

/* Match newlines */
\n                { lines++; chars++; }

/* Match any other character */
.                 { chars++; }

%%

int main(int argc, char *argv[]) {
    FILE *fp;

    if(argc < 2) {
        printf("Usage: %s <filename>\n", argv[0]);
        return 1;
    }

    fp = fopen(argv[1], "r");
    if(!fp) {
        printf("Cannot open file %s\n", argv[1]);
        return 1;
    }

    yyin = fp;
    yylex();

    printf("Lines: %d\n", lines);
    printf("Words: %d\n", words);
    printf("Characters: %d\n", chars);
    printf("Blank spaces: %d\n", blanks);

    fclose(fp);
    return 0;
}
